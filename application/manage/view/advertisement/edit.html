<div style="padding: 30px;" class="layui-form seller-alone-form"> <!-- 提示：如果你不想用form，你可以换成div等任何一个普通元素 -->

    <input type="hidden" name="id" value="{$info.id}">

    <div class="layui-form-item">
        <label class="layui-form-label"><i class="required-color">*</i>商户：</label>
        <div class="layui-form-mid">{$info.seller_id|getSellerInfoById}</div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label"><i class="required-color">*</i>广告位：</label>
        <div class="layui-input-inline seller-inline-3">
            <select name="position_id">
                <option value="{$position.id}">{$position.name}</option>
            </select>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label"><i class="required-color">*</i>广告名称：</label>
        <div class="layui-input-inline seller-inline-5">
            <input type="text" name="name" value="{$info.name}" required lay-verify="required" placeholder="请输入广告名称" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item layui-upload">
        <label class="layui-form-label"><i class="required-color">*</i>广告图片：</label>
        <div class="layui-input-inline seller-inline-5">
            {Jshop:image id='img' name="img" value="$info['img']"/}
        </div>
    </div>


    <div class="layui-form-item">
        <label class="layui-form-label"><i class="required-color">*</i>广告类型：</label>
        <div class="layui-input-inline seller-inline-3">
            <select name="type" lay-filter="type" lay-verify="required">
                {volist name='type' id='vo'}
                    <option value="{$i}" {eq name="$info.type" value="$i"}selected{/eq}>{$vo}</option>
                {/volist}
            </select>
        </div>
    </div>


    <div id="div1"  style="display: none">
        <div class="layui-form-item">
            <label class="layui-form-label"><i class="required-color">*</i>广告链接URL：</label>
            <div class="layui-input-inline seller-inline-5">
                <input type="text" id="url" name="url" value="" required placeholder="请输入合法的URL链接,必须以http://开头" autocomplete="off" class="layui-input">
            </div>
        </div>
    </div>

    <div id="div2"  style="display: none">
        <input type="hidden" name="goods_id" id="goods_id">
        <div class="layui-form-item">
            <label class="layui-form-label"><i class="required-color">*</i>广告商品：</label>
            <div class="layui-input-inline seller-inline-5">
                <input type="text" id="goods" name="goods" readonly="readonly" required placeholder="请选择广告商品" autocomplete="off" class="layui-input" onclick="goods_list()">
            </div>
        </div>
    </div>

    <div id="div3"  style="display: none">
        <input type="hidden" name="article_id" id="article_id">
        <div class="layui-form-item">
            <label class="layui-form-label"><i class="required-color">*</i>广告文章：</label>
            <div class="layui-input-inline seller-inline-5">
                <input type="text" id="article" name="article" readonly="readonly" required placeholder="请选择广告文章" autocomplete="off" class="layui-input" onclick="article_list()">
            </div>
        </div>
    </div>


    <div class="layui-form-item">
        <label class="layui-form-label">排序：</label>
        <div class="layui-input-inline seller-inline-2">
            <input type="text" name="sort" value="{$info.sort}" required lay-verify="required" placeholder="数值越小越靠前" autocomplete="off" class="layui-input">
        </div>
    </div>

    <!-- 更多表单结构排版请移步文档左侧【页面元素-表单】一项阅览 -->
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit lay-filter="edit-advertisement">保存</button>
            <button onclick="javascript:history.back(-1);" type="reset" class="layui-btn layui-btn-primary">取消</button>
        </div>
    </div>
</div>
<script>
    layui.use(['form','table'], function(){
        //监听提交
        var $ = layui.$,form = layui.form,table = layui.table;
        form.render();

        var type = $('select[name=type] option:selected').val();

        if(type == '1')
        {
            $("#div1").show();
            $("input[name=url]").val("{$info.val}");
        }else if(type == '2')
        {
            $("#div2").show();
            $.get("{:url('Advertisement/goodsInfo')}?id={$info.val}",function(res){
                $("#goods_id").val(res.id);
                $("input[name=goods]").val(res.name);
            });
        }else{
            $("#div3").show();
            $.get("{:url('Advertisement/articleInfo')}?id={$info.val}",function(res){
                $("#article_id").val(res.id);
                $("input[name=article]").val(res.title);
            });

        }

        form.on('select(type)', function(data){
            if (data.value == "1") {
                $("#div1").show();
                $("#div2").hide();
                $("#div3").hide();
            }
            if (data.value == "2") {
                $("#div1").hide();
                $("#div2").show();
                $("#div3").hide();
            }
            if (data.value == "3") {
                $("#div1").hide();
                $("#div2").hide();
                $("#div3").show();
            }
        });

        //监听文章列表页工具条
        table.on('tool(articleTable)', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的DOM对象
            if(layEvent === 'selectArticle'){ //选择
                $("#article").val(data.title);
                $("#article_id").val(data.id);
                $("#goods").val('');
                $("#goods_id").val('');
                $("#url").val('');
                layer.close(window.box);
            }
        });

        //监听商品列表页工具条
        table.on('tool(goodsTable)', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的DOM对象
            if(layEvent === 'selectGoods'){ //选择
                $("#goods").val(data.name);
                $("#goods_id").val(data.id);
                $("#article_id").val('');
                $("#article").val('');
                $("#url").val('');
                layer.close(window.box);
            }
        });

        if($("#url").val())
        {
            $("#article_id").val('');
            $("#article").val('');
            $("#goods").val('');
            $("#goods_id").val('');
        }

        //表单提交
        form.on('submit(edit-advertisement)', function(data){
            $.ajax({
                url:"{:url('Advertisement/edit')}",
                type:'post',
                data:data.field,
                success:function(res){
                    if(res.status == true){
                        layer.msg(res.msg, {time:1300},function(){
                            window.location.href = "{:url('advertisement/index')}";
                        });
                    }else{
                        layer.msg(res.msg);
                    }
                }
            });
            return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });

    });
    function goods_list()
    {
        JsGet("{:url('Advertisement/getGoods')}",function(e){
            window.box = layer.open({
                type: 1,
                content: e,
                area: ['700px', '450px'],
                title:'商品列表'
            });
        });
    }

    function article_list()
    {
        JsGet("{:url('Advertisement/getArticle')}",function(e){
            window.box = layer.open({
                type: 1,
                content: e,
                area: ['700px', '450px'],
                title:'文章列表'
            });
        });
    }
</script>