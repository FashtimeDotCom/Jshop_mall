<form class="layui-form seller-form"  action="" >
    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">商户：</label>
            <div class="layui-input-inline seller-inline-4">
                <select name="seller_id" lay-verify="">
                    <option value=""></option>
                    {volist name="sellerList" id="vo"}
                    <option value="{$vo.id}">{$vo.seller_name}</option>
                    {/volist}
                </select>
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">key：</label>
            <div class="layui-input-inline seller-inline-4">
                <select name="skey" lay-verify="">
                    <option value=""></option>
                    {volist name="skeys" id="vo"}
                    <option value="{$key}">{$vo.name}</option>
                    {/volist}
                </select>
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">value：</label>
            <div class="layui-input-inline seller-inline-5">
                <input type="text" name="value" lay-verify="title" placeholder="请输入值" autocomplete="off" class="layui-input">
            </div>
        </div>

        <div class="layui-inline">
	        <div class="layui-input-block">
	            <button class="layui-btn layui-btn-sm" lay-submit lay-filter="*"><i class="iconfont icon-chaxun"></i>筛选</button>
	        </div>
        </div>
    </div>
</form>

<div class="table-body">
    <table id="userTable" lay-filter="userTable"></table>
</div>

<script>
    layui.use(['form', 'layedit', 'laydate','table'], function(){
        layui.table.render({
            elem: '#userTable',
            height: 'full-218',
            cellMinWidth: '80',
            page: 'true',
            limit:'20',
            url: "{:url('sellerSetting/index')}?_ajax=1",
            id:'userTable',
            cols: [[
                {type:'numbers'},
//                {field:'username', width:100,title:'账号'},
                {field:'seller_name', width:250,title:'商户名称'},
                {field:'key_name', minWidth: 50,title:'key'},
                {field:'value',title:'value', edit: 'text'},
            ]]
        });
        layui.form.on('submit(*)', function(data){
            layui.table.reload('userTable', {
                where: data.field
                ,page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
            return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });
        //监听单元格编辑
        layui.table.on('edit(userTable)', function(obj){
            console.log(obj);
            var value = obj.value //得到修改后的值
                    ,data = obj.data //得到所在行所有键值
                    ,field = obj.field; //得到字段
            thedata = {
                seller_id:obj.data.seller_id,
                skey:obj.data.skey,
                value:obj.value
            };
            console.log(thedata);
            JsPost('{:url("SellerSetting/edit")}',thedata,function (re) {
                if(re.status){
                    layer.msg('保存成功');
                }else{
                    layer.msg(re.msg);
                    layui.table.reload('userTable');
                }
            });
        });
    });
</script>
