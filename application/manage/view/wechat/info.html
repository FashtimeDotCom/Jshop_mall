<style>
    .layui-img{
        width: 80px;
        height: 80px;
        margin-right: 10px;
        /*border-radius: 50%;*/
    }
    .text-content{
        padding: 10px;
    }
    .text-content .layui-input-inline{
    	margin-top: 5px;
    }
    
</style>
{if condition="$order_id eq false "}
<div class="warning-msg">
    <div class="warning-msg-content">
        <i class="iconfont icon-tanhao"></i><p>您还未启用模板，请先启用模板哦。<a href="{:url('wechat/template')}" >[立即启用]</a></p>
    </div>
</div>
{/if}

<div class="layui-form layui-border-box layui-table-view">
    <div class="">
        {if condition="$isAuthor eq 'true'"}
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">小程序名称：</label>
            <div class="layui-form-mid ">{$authorInfo.nick_name}</div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">是否认证：</label>
            <div class="layui-form-mid ">
                {if condition="$authorInfo.verify_type_info eq '-1'"}
                <div style="color: #FF5722;">未认证</div>
                {elseif condition="$authorInfo.verify_type_info eq '0'"/}
                <div style="color: #5FB878;">已认证</div>
                {else/}
                <div style="color: #2F4056;">未知</div>
                {/if}
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">AppId：</label>
            <div class="layui-form-mid ">{$authorInfo.appid}</div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">AppSecret：</label>
            <div class="layui-form-mid ">{$authorInfo.appsecret}</div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">原始Id：</label>
            <div class="layui-form-mid ">{$authorInfo.user_name}</div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">主体：</label>
            <div class="layui-form-mid ">{$authorInfo.principal_name}</div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">小程序简介：</label>
            <div class="layui-form-mid ">{$authorInfo.signature}</div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">小程序logo：</label>
            <div class="layui-form-mid "><img class="layui-img" src="{$authorInfo.head_img}"></div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label seller-inline-3">小程序二维码：</label>
            <div class="layui-form-mid "><img class="layui-img" src="{$authorInfo.qrcode_url}"></div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <a class="layui-btn" href="{:url('wechat/edit',['id'=>$authorInfo.id])}" lay-filter="editinfo">完善信息</a>
            </div>
        </div>
        {else/}

        <div class="text-content">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label seller-inline-3">
                        您还未绑定小程序
                    </label>
                    <div class="layui-input-inline">
                        <button class="layui-btn layui-btn-sm layui-btn-normal" id="bind">去绑定</button>
                    </div>
                </div>
            </div>
        </div>
        {/if}
    </div>
</div>
<script>
    layui.use(['laytpl','layer'],function(){
        $("#bind").click(function () {
            JsGet("{:url('wechat/index')}",function (e) {
                window.box = layer.open({
                    type: 1,
                    content: e.data,
                    area: ['400px', '300px'],
                    title: "请先绑定小程序",
                    closeBtn: 1,
                    shadeClose: false,
                    btnAlign:'c',
                    btn:['不绑定，先逛逛'],
                    yes:function (index) {
                        //随便逛逛
                        JsGet("{:url('wechat/closeAuthor')}",function (e) {
                            layer.closeAll();
                        });
                    }
                });
            });
        });
        {if condition="$authorInfo.bind_type eq '1'"}
            $("#cancleAuthor").click(function () {
                layer.confirm('确定取消授权？变更会删除之前授权信息！本平台取消授权后，需手动至微信小程序后台取消授权。<br/>查看<a href="" style="color: #5FB878;">教程</a>', {
                    btn: ['再考虑考虑','确定'],
                    title:'取消授权',
                }, function(){
                    layer.closeAll();
                },function(){
                    JsGet("{:url('wechat/changeAuthor')}",function (e) {
                        if(e.status === true){
                            layer.msg(e.msg, {time: 1300}, function(){
                                window.location.href='{:url("wechat/info")}';
                            });
                        }else{
                            layer.msg(e.msg, {time: 1300});
                        }
                    });
                });
            });
            $("#setAdmin").click(function () {
                JsPost("{:url('wechat/setDomain')}",function (e) {
                    if(e.status === true){
                        layer.msg(e.msg, {time: 1300}, function(){
                            //window.location.href='{:url("wechat/info")}';
                            window.location.href='{:url("message_center/message")}';
                        });
                    }else{
                        layer.msg(e.msg, {time: 1300});
                    }
                });
            });
        {/if}
        {if condition="$authorInfo.bind_type neq '1'"}
        $("#changeAuthor").click(function () {
            layer.confirm('确定要变更授权方式？变更会删除之前授权信息！', {
                btn: ['再考虑考虑','确定'],
                title:'变更授权',
            },function(){
                layer.closeAll();
            }, function(){
                JsGet("{:url('wechat/changeAuthor')}",function (e) {
                    if(e.status === true){
                        layer.msg(e.msg, {time: 1300}, function(){
                            window.location.href='{:url("wechat/info")}';
                        });
                    }else{
                        layer.msg(e.msg, {time: 1300});
                    }
                });
            });
        });
        {/if}

    })

</script>